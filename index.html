<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>2x YouTube (no autoplay)</title>
    <style>
      /* Full-bleed page (important for Notion embeds) */
      html, body {
        width: 100%;
        height: 100%;
        margin: 0;
        padding: 0;
        background: transparent; /* no black border from your page */
        overflow: hidden;
      }

      /* Player fills the entire iframe */
      #player {
        position: fixed;
        inset: 0;
        width: 100vw;
        height: 100vh;
      }

      /* Ensure the injected YouTube iframe fills too */
      #player iframe {
        position: absolute;
        inset: 0;
        width: 100%;
        height: 100%;
        border: 0;
        display: block;
      }
    </style>
  </head>

  <body>
    <div id="player"></div>

    <script>
      const VIDEO_ID = "pYLxtEYevp8";
      const TARGET_RATE = 2;

      // Load the YouTube IFrame Player API
      (function loadYT() {
        const tag = document.createElement("script");
        tag.src = "https://www.youtube.com/iframe_api";
        document.head.appendChild(tag);
      })();

      let player;
      let lastState = -1;

      // Called automatically by the YT API once it's ready
      function onYouTubeIframeAPIReady() {
        player = new YT.Player("player", {
          videoId: VIDEO_ID,
          playerVars: {
            autoplay: 0,   // no autoplay
            controls: 1,
            rel: 0,
            playsinline: 1
          },
          events: {
            onStateChange: onPlayerStateChange
          }
        });
      }

      function forceRate() {
        try {
          const rates = player.getAvailablePlaybackRates?.() || [];
          if (rates.length && !rates.includes(TARGET_RATE)) {
            player.setPlaybackRate(rates[rates.length - 1]); // fallback to highest
            return;
          }
          player.setPlaybackRate(TARGET_RATE);
        } catch (_) {}
      }

      function onPlayerStateChange(event) {
        const state = event.data;

        // When user presses play -> force 2x (and again shortly after)
        if (state === YT.PlayerState.PLAYING && lastState !== YT.PlayerState.PLAYING) {
          forceRate();
          setTimeout(forceRate, 250);
          setTimeout(forceRate, 1000);
        }

        lastState = state;
      }
    </script>
  </body>
</html>
